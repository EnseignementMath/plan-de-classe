<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Plan de classe - Liste libre</title>
  <style>
    body { font-family: sans-serif; background: #f6f9fb; padding: 32px;}
    h1 { text-align: center; }
    .setup, .actions { margin-bottom: 1.5em; text-align: center;}
    .input-list { width: 260px; min-height: 80px; }
    .cases-list { display: flex; flex-wrap: wrap; gap: 18px; justify-content: center; margin-bottom: 18px;}
    .case {
      min-width: 120px; min-height: 52px; background: #91d4ef;
      border-radius: 17px; display: flex; align-items: center; justify-content: center;
      font-weight: bold; font-size: 1.18em; color: #111;
      border: 2px solid #a2cee9;
      cursor: grab;
      box-shadow: 0 2px 10px #0001;
      transition: box-shadow .2s, background .2s;
      margin: 2px;
      position: relative;
      z-index: 1;
      overflow: hidden;
    }
    .case.drag-over {
      background: #e6ffef !important;
      box-shadow: 0 0 0 4px #169ec3, 0 2px 10px #0002;
    }
    .case.empty { background: #d7eefa; color: #aaa;}
    .eleve-list { display: flex; flex-wrap: wrap; gap: 7px; margin: 12px 0 22px 0; justify-content: center;}
    .eleve {
      background: #fff; border-radius: 10px; padding: 8px 16px; margin: 2px;
      box-shadow: 0 1px 4px #0001; font-size: 1.04em; cursor: grab; border: 1.5px solid #8fcbe5;
      user-select: none; display: inline-block; transition: box-shadow .2s, background .2s;
    }
    .eleve:active { background: #d7f7ee;}
    .export-box { width: 100%; height: 100px; margin-top: 10px; font-family: monospace;}
    label { font-weight: bold;}
    .actions { margin-top: 2em; }
    .help { font-size: 0.96em; color: #777; margin-top: 1.2em;}
    .btn-swap { background: #f5b; color: #fff; border: none; border-radius: 4px; font-size: 0.9em; padding: 3px 6px; cursor: pointer;}
    .btn-swap:hover { background: #d08; }
  </style>
</head>
<body>
  <h1>üß© Plan de classe ‚Äî Liste libre / Ordre manuel</h1>
  <div class="setup">
    <label>Liste des pr√©noms (un pr√©nom par ligne):</label><br>
    <textarea id="eleves-input" class="input-list" placeholder="Pr√©nom 1&#10;Pr√©nom 2"></textarea>
    <br><br>
    <label>Nombre de cases √† placer‚ÄØ:</label>
    <input type="number" id="nb-cases-input" value="20" min="2" max="80" style="width:3.5em;">
    <button onclick="genererCases()">Cr√©er les cases</button>
  </div>

  <div class="eleve-list" id="eleve-list"></div>

  <div id="cases-list" class="cases-list"></div>

  <div class="actions">
    <button onclick="exporterListe()">Exporter la liste</button>
    <br>
    <textarea id="export-output" class="export-box" readonly placeholder="Copie-colle ici pour ton code matrice‚Ä¶"></textarea>
  </div>
  <div class="help">
    - Glisse un pr√©nom dans une case pour l‚Äôy placer<br>
    - Tu peux r√©ordonner les cases par drag & drop (ou laisser des cases vides)<br>
    - Clique sur "Exporter la liste" pour avoir la liste √† coller dans ton site
  </div>

<script>
let eleves = [], nbCases = 20, listeCases = [];

function genererCases() {
  // Pr√©noms de gauche
  eleves = document.getElementById('eleves-input').value
    .split('\n').map(x => x.trim()).filter(x => !!x);
  nbCases = parseInt(document.getElementById('nb-cases-input').value) || 1;

  // Cases vides
  listeCases = Array(nbCases).fill('');

  // Zone pr√©noms non plac√©s
  document.getElementById('eleve-list').innerHTML = '';
  eleves.forEach(prenom => {
    const e = document.createElement('div');
    e.className = 'eleve';
    e.textContent = prenom;
    e.draggable = true;
    e.ondragstart = ev => { ev.dataTransfer.setData("text/plain", prenom); };
    e.dataset.nom = prenom;
    document.getElementById('eleve-list').appendChild(e);
  });

  // Cases placables
  renderCases();
}

function renderCases() {
  const zone = document.getElementById('cases-list');
  zone.innerHTML = '';
  listeCases.forEach((val, idx) => {
    const cell = document.createElement('div');
    cell.className = 'case' + (val ? '' : ' empty');
    cell.draggable = true;
    cell.ondragstart = e => {
      e.dataTransfer.setData("case-index", idx);
      e.dataTransfer.effectAllowed = "move";
    };
    cell.ondragover = e => e.preventDefault();
    cell.ondragenter = e => cell.classList.add('drag-over');
    cell.ondragleave = e => cell.classList.remove('drag-over');
    cell.ondrop = function(e) {
      cell.classList.remove('drag-over');
      const fromCaseIdx = e.dataTransfer.getData("case-index");
      const prenom = e.dataTransfer.getData("text/plain");
      if (prenom) {
        // Drag depuis la liste de pr√©noms ou une autre case
        if (cell.textContent && cell.textContent !== prenom) {
          // √âchange entre deux cases ou liste‚Üícase (case occup√©e)
          const old = cell.textContent;
          // Replace le pr√©nom √©vinc√© √† sa place
          if (fromCaseIdx !== "" && !isNaN(fromCaseIdx)) {
            // Cas case‚Üícase : swap
            listeCases[fromCaseIdx] = old;
          } else {
            // Cas liste‚Üícase : remet le pr√©nom dans la liste
            const el = document.createElement('div');
            el.className = 'eleve'; el.textContent = old;
            el.draggable = true;
            el.ondragstart = ev => { ev.dataTransfer.setData("text/plain", old); };
            el.dataset.nom = old;
            document.getElementById('eleve-list').appendChild(el);
          }
        }
        listeCases[idx] = prenom;
        renderCases();
        // Supprime l‚Äô√©l√®ve de la liste
        Array.from(document.getElementsByClassName('eleve')).forEach(e => {
          if (e.dataset.nom === prenom) e.remove();
        });
      } else if (fromCaseIdx !== "" && !isNaN(fromCaseIdx)) {
        // Drag & drop pour √©changer l‚Äôordre des cases
        const swapIdx = parseInt(fromCaseIdx);
        [listeCases[swapIdx], listeCases[idx]] = [listeCases[idx], listeCases[swapIdx]];
        renderCases();
      }
    };
    // Affiche le pr√©nom dans la case
    if (val) cell.textContent = val;
    else cell.textContent = '';
    zone.appendChild(cell);
  });
}

function exporterListe() {
  let out = JSON.stringify(listeCases.map(v => v || 0), null, 2);
  document.getElementById('export-output').value = out + "\n// √Ä coller dans ta variable matrice dans ton code";
}
</script>
</body>
</html>
